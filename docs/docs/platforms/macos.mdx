# macOS

Platform-specific information for running Mystral Native.js on macOS.

## System Requirements

- macOS 12.0 (Monterey) or later
- Apple Silicon (arm64) or Intel (x64) processor
- Metal-capable GPU

## Recommended Build

For macOS, we recommend:

```bash
# Apple Silicon
mystral-macOS-arm64-v8-dawn.zip

# Intel Mac
mystral-macOS-x64-v8-dawn.zip
```

**V8 + Dawn** provides the best experience with full ES2024+ JavaScript and Chrome's WebGPU implementation.

## Installation

### Quick Install

```bash
curl -fsSL https://mystralengine.github.io/mystralnative/install.sh | bash
```

### Manual Install

```bash
# Download
curl -L -o mystral.zip https://github.com/mystralengine/mystralnative/releases/latest/download/mystral-macOS-arm64-v8-dawn.zip

# Extract
unzip mystral.zip
cd mystral-macOS-arm64-v8-dawn

# Make executable
chmod +x mystral

# Optional: move to PATH
sudo mv mystral /usr/local/bin/
```

## Gatekeeper

macOS may block unsigned binaries. To allow:

```bash
# Remove quarantine attribute
xattr -d com.apple.quarantine ./mystral

# Or allow in System Preferences
# Privacy & Security > Allow "mystral"
```

## Building from Source

### Prerequisites

```bash
# Install Xcode command line tools
xcode-select --install

# Install dependencies via Homebrew
brew install cmake ninja
```

### Build Commands

```bash
git clone https://github.com/mystralengine/mystralnative.git
cd mystralnative

bun install
bun run deps:download
bun run configure
bun run build

./build/mystral --version
```

### Universal Binary

Build for both arm64 and x64:

```bash
cmake -B build \
    -DCMAKE_OSX_ARCHITECTURES="arm64;x86_64" \
    -DMYSTRAL_USE_V8=ON \
    -DMYSTRAL_USE_DAWN=ON

cmake --build build
```

## Available Configurations

| JS Engine | WebGPU Backend | Notes |
|-----------|----------------|-------|
| V8 | Dawn | Recommended, full ES2024+ |
| V8 | wgpu-native | Good compatibility |
| QuickJS | Dawn | Smaller binary |
| QuickJS | wgpu-native | Smallest binary |
| JSC | Dawn | Uses system JavaScriptCore |
| JSC | wgpu-native | Best for iOS code sharing |

## Known Issues

### Audio Shutdown (Exit Code 137)

When using Web Audio, the process may exit with code 137 during shutdown. This is a known SDL3/CoreAudio interaction issue. Audio works correctly during runtime; only the cleanup phase is affected.

### Metal Validation

For debugging WebGPU issues, enable Metal validation:

```bash
METAL_DEVICE_WRAPPER_TYPE=1 mystral run game.js
```

## Performance Tips

- **V8 JIT**: V8 provides significant performance improvements for complex JavaScript
- **Dawn**: Generally faster shader compilation than wgpu-native on macOS
- **Release builds**: Always use Release builds for production

## Next Steps

- [Running Games](/mystralnative/docs/guides/running-games) - CLI usage
- [Building from Source](/mystralnative/docs/guides/building) - Build options
